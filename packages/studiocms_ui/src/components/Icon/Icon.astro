---
import { type AvailableIcons, type IconCollections, iconCollections } from 'studiocms:ui/icons';
import * as Icons from 'studiocms:ui/icons';
import type { HTMLAttributes } from 'astro/types';
import IconBase from './IconBase.astro';
import { StudioCMS_UI_IconError, errorHintBuilder } from './errors.js';

interface Props extends HTMLAttributes<'svg'> {
	name: AvailableIcons;
	height?: number;
	width?: number;
}

const { name, ...rest } = Astro.props;

const [prefix, iconName] = name.split(':');

const collection = Icons[prefix as IconCollections];

if (!prefix || !iconCollections.includes(prefix as IconCollections) || !collection) {
	throw new StudioCMS_UI_IconError(
		`Invalid icon collection: ${prefix}`,
		errorHintBuilder({ iconCollections, prefix, iconName })
	);
}

if (!iconName) {
	throw new StudioCMS_UI_IconError(`Invalid icon name: ${iconName}`);
}
---
<IconBase iconCollection={collection} name={iconName} {...rest} />
