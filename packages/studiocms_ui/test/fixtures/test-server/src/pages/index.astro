---
import Layout from '../layouts/Layout.astro';

interface CurrentTest {
	label: string;
	href: string;
}

// Import all test files in the current directory that match the pattern '*-test.astro'
const testFilesPaths: Record<string, unknown> = import.meta.glob('./*-test.astro', { eager: true });

// Get the file paths and filter out the template test file itself
// Then, remove the '.astro' extension for easier handling
const testFiles: string[] = Object.keys(testFilesPaths)
	.filter((path) => path !== './_template-test.astro')
	.map((path) => path.replace('.astro', ''));

// Create an array of current tests with labels and paths for rendering in the UI
const currentTests: CurrentTest[] = testFiles.map((path) => ({
	label: path
		// remove the leading './', path prefix
		.replace('./', '')
		// remove the '-test' suffix
		.replace(/-test/g, '')
		// replace hyphens with spaces
		.replace(/-/g, ' ')
		// capitalize each word
		.replace(/\b\w/g, (c) => c.toUpperCase()),

	// The path to the test file converted to a web-safe URL path
	href: path.replace('./', '/'),
}));
---

<Layout>
	<h1>Available Test Fixtures</h1>
	<ul>
		{
			currentTests.map(({ label, href }) => (
				<li>
					<a {href}>{label}</a>
				</li>
			))
		}
	</ul>
</Layout>
